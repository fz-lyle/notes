# 1.网络基础

---

## 🔥HTTP协议

### 1.当我们输入网址后发生了什么？

**浏览器，还有一些工具，把一些细节都给隐藏了**，我要探索一下这些细节

浏览器行为与HTTP协议（加一些图片之类的看看，中间转发了多少，还有能不能上网的试试）

- 用户输入网址 按下回车
- 浏览器第一件事：先看网络通不通（再深一层就是路由器，网关）（浏览器如何判断网络通不通）
- 网络通的话，浏览器操作 计算机底层发送网络请求的API，向DNS发送解析（因为浏览器不认识域名）
- DNS服务器给浏览器返回了 IP地址，浏览器继续 通过这个IP地址继续发送（因为浏览器和目标地址之间，不可能一条线通着的，中间还有很多透明设备（对于用户是不可见的），网关，路由器等等），经过一些列的转发之后，到达目的地（唯一的服务器）
- 服务器接收到请求之后，经过一些处理，把响应结果返回（字符串）
- 返回过程也经过一些路由，最终返回到 用户浏览器中

---

**猫 和 路由器**

- 猫：是和 各个通信商之间的一条链路
- 路由器：路铺好了，路由器就是告诉怎么走的，就是告诉 DNS服务器

---

**什么是HTTP协议？**

- HTTP是超文本传输协议，从www浏览器传输到本地浏览器的一种传输协议，网站是基于HTTP协议的，例如网站上的图片，CSS,JS等都是基于HTTP协议进行传输的（说白了就是一个有特定套路的拿数据的东西）
- HTTP协议是由从客户机到服务器的请求（request）和 从服务器到客户机（response）进行约束和规范的


---

**http 和 https**

http属于应用层协议（现在http广泛使用的是1.1，但是2.0也在使用）

很多网站都把 http 换成 https，他们很多地方都是相同的，你可以把https当成 http的升级版，不同的是多了一个加密的模块（TLS,SSL）

---

**拓展阅读：TCP/IP的发展史**




---

### 2.http协议详解

**工作流程**

---

**请求和响应（看浏览器的network面板最好）**

http请求组成：请求行，消息报头，请求正文
http响应组成：状态行，消息报头，响应正文

---

**请求报文**

- Accept：我这个浏览器能够接收什么资源
- Accept-Encoding: 浏览器接受数据的格式是什么？可以设置支不支持gzip格式（压缩格式）等
- Accept-Language：接收的语言
- Coche-Control：缓存相关
- 🔥Connetion：keep-alive（http的一种 连接模式，最常用的是长连接 keep-alive）
    - 短连接：每一次http的请求和响应，都会反复建立和断开TCP连接，占用服务器IO操作
    - 长连接：建立一个TCP链接，然后进行多次HTTP通信
- Cookie：
- Host：访问的网站
- User-Agent：包含浏览器的一些信息，电脑系统等，就是浏览器向服务器介绍自己的一个（做爬虫的时候能用到，因为反爬虫的一个就是判断你是不是浏览器）

---

**响应报文**

- Coche-Control：缓存相关
- Connetion：keep-alive（返回形式是长连接）
- Content-Encoding: gzip（返回的格式）
- Content-Type: text/html（返回的类型）
- Date: 缓存相关（时间戳）
- Expires：缓存相关
- Sever：服务器（例如 NGINX）


---

**http状态码**

- 2xx：成功 - 表示请求被成功接收，理解，接受
- 4xx：客户端错误 - 请求有语法错误或请求无法实现
- 5xx：服务器端发生错误 - 服务器未能实现合法的请求（后端程序出错，网络出错，服务器服务错误）
- 3xx：重定向 - 要完成请求必须进行更近一步的操作（服务器让你读本地缓存的时候可以用到，服务器端也能能用）
- 1xx：指示信息 - 表示请求已接收，继续处理（用到异步处理上，后端常用，前端很少见）

---

**请求方法**

- GET
- POST
- PUT
- DELETE
- HEAD
- TRACE
- CONNECT
- OPTIONS: 请求查询服务器性能或者查询与资源相关的选项和需求

---

**cookies和session**

- cookies 是保存在客户端的小段文本 一般都是服务器端生成返回给客户端浏览器
- session 保存在服务器端，通过唯一的值sessionID来区分每一个用户，sessionID随每个连接请求发送到服务器，服务器更具sessionID来识别客户端，再通过session 的key值 获取 session 值
- 因为http是无状态的（这里的状态不是状态码那些东西，而是指的是服务器端不知道某个请求是哪个浏览器发的这类信息）

---

**token**

- 要下发到你的客户端，也要和
- 验证流程上和session不一样，是一个安全性更高的机制

---

**缓存机制**

- 浏览器 ---》 无缓存 ---》请求服务器 ---》请求响应，协商缓存 ---》
- 缓存机制其本质是两种策略（Etag/If-None-Match策略）
    - Etag：web服务器响请求时，告诉浏览器当前资源在服务器的唯一标识（由服务器生成规则）
    - 

---

**HTTP链路安全**

- HTTP传递的是文本信息，如果没有安全的话，你可以拦截任意人的数据并查看
- 对传输的内容进行加密
    - 直接加密数据（数据太大的话，对重要数据进行加密，例如密码等）（❣️我这里发送的时候是明文发送的...）
    - 链路加密：使用https

---

**HTTP2（提高性能）**

- 使用二进制格式进行传输（不是传纯文本了，更加高效，紧凑）
- 对报头压缩，降低开销
- 多路复用，一个网络连接实现并行请求
- 服务器主动推送，减少请求的延迟（跟ajax，websocket）

---

**反向代理**

- 什么是代理：（代理服务器一般和目标服务器不在一个地方，没关系）
    - 作用一：可以审查内网和外网（特别大的公司有自己的内网，并对自己的请求有严格的要求，这时候可能会架设中间代理检测服务器）
    - 作用二：加速用，可以在代理服务器上放缓存
- 什么是反向代理：反向代理服务器一把和目标服务器在一个网络下（或一个网域内），经常被当做入口，这种通过一个入口去访问目标服务器的，叫反向代理
- 为什么要用反向代理：
    - 加密和SSL加速
    - 负载均衡（会把流量压力，分布到不同的服务器上）
    - 缓存静态内容
    - 压缩（一般也是在反向代理上进行 gzip压缩）
    - 减速上传（限制流量带宽）
    - 安全（在黑客攻击目标服务器前，有一层反向代理服务器，增加攻击成本）
    - 外网发布...（现在国家不让了）
- 都要哪些反向代理服务器：


---

**NGINX使用**

```
```

---


## 性能优化










